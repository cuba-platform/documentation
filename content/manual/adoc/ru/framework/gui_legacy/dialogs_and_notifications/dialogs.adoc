:sourcesdir: ../../../../../source

[[dialogs]]
===== Диалоговые окна

[WARNING]
====
Это устаревший API. Новый API, доступный начиная с v.7.0, описан в разделе <<gui_dialogs>>.
====

Диалоги общего назначения::
+
--
Диалоговые окна общего назначения вызываются методами `showMessageDialog()` и `showOptionDialog()` интерфейса `Frame`. Этот интерфейс реализуется <<screen_controller,контроллером экрана>>, поэтому данные методы можно вызывать напрямую в коде контроллера.

[[dialogs_showMessageDialog]]
* `showMessageDialog()` предназначен для отображения сообщения. Метод принимает следующие параметры:

** `title` - заголовок диалогового окна.

** `message` - сообщение. В случае HTML-типа (см. ниже) в сообщении можно использовать теги HTML для форматирования. При использовании HTML обязательно экранируйте данных из БД во избежание code injection в веб-клиенте. В не-HTML сообщениях можно использовать символы `\n` для переноса строки. 

** `messageType` - тип сообщения. Возможные типы:

*** `CONFIRMATION`, `++CONFIRMATION_HTML++` - диалог подтверждения. 

*** `WARNING`, `++WARNING_HTML++` - диалог преупреждения.
+
Различие типов сообщений отражается только в пользовательском интерфейсе десктоп-приложений.
+
Типы сообщений могут быть установлены с параметрами:
+
**** `width` - ширина диалога,
+
**** `modal` - модальность диалога,
+
**** `maximized` - должен ли диалог быть развёрнут во весь экран,
+
**** `closeOnClickOutside` - возможность закрыть диалог кликом по любой области за его пределами.
+
Пример вызова диалога:
+
[source, java]
----
include::{sourcesdir}/gui/dialogs_1.java[]
----

[[dialogs_showOptionDialog]]
* `showOptionDialog()` предназначен для отображения сообщения и кнопок для выбора пользователем. Метод в дополнение к параметрам, описанным для `showMessageDialog()`, принимает массив или список <<gui_Action,действий>>. Для каждого действия в диалоге создается кнопка, при нажатии на которую пользователем диалог закрывается и вызывается метод `actionPerform()` данного действия.
+
В качестве кнопок со стандартными названиями и значками удобно использовать анонимные классы, унаследованные от `DialogAction`. Поддерживаются пять видов действий, определяемых перечислением `DialogAction.Type`: `OK`, `CANCEL`, `YES`, `NO`, `CLOSE`. Названия соответствующих кнопок извлекаются из <<main_message_pack,главного пакета>> локализованных сообщений.
+
Пример вызова диалога с кнопками *Да* и *Нет* и с заголовком и сообщением, взятыми из пакета локализованных сообщений текущего экрана:
+
[source, java]
----
include::{sourcesdir}/gui/dialogs_2.java[]
----
+
Параметр `Status` конструктора `DialogAction` используется для определения визуального стиля кнопки, к которой привязано данное действие. Статус `Status.PRIMARY` подсвечивает кнопку и задаёт ей выделение по умолчанию. Параметр `Status` можно не использовать, в этом случае используется подсветка кнопок по умолчанию.  Если в `showOptionDialog` передано несколько действий с `Status.PRIMARY`, то фокус и стиль получает только кнопка первого такого действия в списке.
--

[[dialogs_fileUploadDialog]]
Диалог загрузки файлов::
+
--
Диалоговое окно `FileUploadDialog` предоставляет базовую функциональность загрузки файлов в <<file_upload,промежуточное хранилище>>. Оно содержит drop zone для перетаскивания файлов извне браузера и кнопку загрузки файла.

image::gui_fileUploadDialog.png[align="center"]

Открыть диалог можно с помощью метода `openWindow()`, в случае успешной загрузки окно будет закрыто с `COMMIT_ACTION_ID`. Закрытие диалога можно отслеживать с помощью слушателей `CloseListener` и `CloseWithCommitListener`. Чтобы получить UUID и имя загруженного файла, используйте методы `getFileId()` и `getFileName()`. Затем для файла можно, например, создать `FileDescriptor`, позволяющий ссылаться на него из объектов модели данных, или реализовать другую логику.

[source, java]
----
include::{sourcesdir}/gui/dialogs_3.java[]
----
--

